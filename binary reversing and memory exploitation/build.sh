#!/bin/bash

# Clean option
if [ "$1" == "clean" ]; then
    echo "Cleaning up..."
    if [ -f format_string ]; then
        rm format_string
        echo "Removed format_string"
    fi
    if [ -f corrupting_stack ]; then
        rm corrupting_stack
        echo "Removed corrupting_stack"
    fi
    if [ -f ret2win ]; then
        rm ret2win
        echo "Removed ret2win"
    fi
    if [ -f ret2shellcode ]; then
        rm ret2shellcode
        echo "Removed ret2shellcode"
    fi
    exit 0
fi

# Compile the format_string.c file (VM ASLR can be or not disabled)
if [ -f format_string ]; then
    rm format_string
fi
gcc -o format_string format_string.c

# Compile the corrupting_stack.c file (VM ASLR can be or not disabled)
if [ -f corrupting_stack ]; then
    rm corrupting_stack
fi
gcc -o corrupting_stack corrupting_stack.c -fno-stack-protector -z execstack -no-pie

# Compile the ret2win.c file (VM ASLR can be or not disabled)
if [ -f ret2win ]; then
    rm ret2win
fi
gcc -o ret2win ret2win.c -fno-stack-protector -z execstack -no-pie

# Compile the ret2shellcode.c file (VM ASLR must disabled)
if [ -f ret2shellcode ]; then
    rm ret2shellcode
fi
gcc -o ret2shellcode ret2shellcode.c -fno-stack-protector -z execstack -no-pie
