#include <stdio.h>
#include <string.h>
#include <unistd.h>

int main() {

    // Lee la flag del fichero flag.txt

    char flag[32] = {0};
    FILE *f = fopen("flag.txt", "r");
    fgets(flag, 32, f);
    fclose(f);
    
    char name[64] = {0};

    printf("Enter your name: ");
    fflush(stdout);
    read(0, name, 64);

    printf("\nHello ");
    printf(name);  // Vulnerabilidad de format string
    printf("\n! Can you find the flag?\n");
    // printf("Hello %s! Can you find the flag?\n", name); // Forma segura

    return 0;
}
